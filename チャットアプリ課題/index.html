<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div class="container">  
        <div class="ã‚¿ã‚¤ãƒˆãƒ«"> è…é‡ã®ãƒãƒ£ãƒƒãƒˆ</div>
         <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤ºç”»é¢ -->
        <div>
            <div class="chat-area" id="output"></div>  
            <div>
                ã‚¿ã‚¤ãƒˆãƒ«ï¼š<input type="text" id="uname">
            </div>
            <div>
                <textarea id="text" cols="30" rows="10"></textarea>
                <button id="send">é€ä¿¡</button>
            </div>
           
        </div>
    </div>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!--ä»¥ä¸‹Fire-->
    
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-analytics.js";

        //è¿½åŠ 1
        import { getDatabase, ref, push, set, onChildAdded, remove, onChildRemoved } 
from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyDoJKsJbNabpDSwby88X5ttxTBVamaG3Hw",
          authDomain: "gsdemo-e0c6e.firebaseapp.com",
          projectId: "gsdemo-e0c6e",
          storageBucket: "gsdemo-e0c6e.appspot.com",
          messagingSenderId: "979709919401",
          appId: "1:979709919401:web:12f3d386a8ec67a5dea9b8",
          measurementId: "G-L30JTZBZGD"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);

    // è¿½åŠ 2
        const db  = getDatabase(app); //RealtimeDBã«æ¥ç¶š
        const dbRef = ref(db,"chat"); //RealtimeDBå†…ã®"chat"ã‚’ä½¿ã†

        // é€ä¿¡å‡¦ç†
        $('#send').on('click', function(){
      //å‹•ã„ãŸã‚‰alertã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ãŠãã¾ã—ã‚‡ã†ï¼
      // é€ä¿¡ã®å‡¦ç†ã‚’è¨˜è¿°ã—ã¦ã„ãã¾ã™ğŸ¤—
 // id='uname' ã¤ã¾ã‚Š #uname åå‰ã®ã¨ã“ã‚
      // id='text' ã¤ã¾ã‚Š #text ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®ã¨ã“ã‚
      const text = $('#text').val();
      const uname = $('#uname').val();

      // ãƒ‡ãƒ¼ã‚¿ã®å¡Šã‚’ä½œæˆã—ã¦ã„ã‚‹
      const msg = {
       uname: $('#uname').val(),
       text: $('#text').val(), 
      }

      //ãƒ¦ãƒ‹ãƒ¼ã‚¯KEYã‚’ç”Ÿæˆ = çµ¶å¯¾ã«ã‹ã¶ã‚‰ãªã„ç•ªå·ã¿ãŸã„ãªã‚‚ã®
      const newPostRef = push(dbRef);
      //"chat"ã«ãƒ¦ãƒ‹ãƒ¼ã‚¯KEYã‚’ã¤ã‘ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²
      set(newPostRef, msg);
      

      // alert(uname + text);ã€€å…¥åŠ›ã®ãƒã‚§ãƒƒã‚¯ã‚’ã—ã¾ã—ãŸ

    });

    // å—ä¿¡å‡¦ç†
    onChildAdded(dbRef,function(date){
        const msg = date.val();
        const key = date.key;
        let h ="<p>";
            h +=msg.uname;
            h +='<br>';
            h += msg.text;
            h += '</p>';
            $("#output").append(h);
      });
      </script>
   
   <script>
    //    const test = {
    //        gs:"momo",
    //        gs2:"å‰",
    //        gs3:"å¾Œã‚",
    //        gs4:1,
    //    } 
    // const momotaro = {
    // name: 'momotaro',
    // syumi: 'ã‚²ãƒ¼ãƒ ',
    // sukinamono: '0â†’1',
    // }

    // console.log(momotaro,"æ¼”ç¿’1")
    
    </script>

    
</body>
</html>